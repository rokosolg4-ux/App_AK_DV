<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–í–¢–û–ö–†–ê–°–ö–ò –î–í PRO | Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg: #f8f9fa;
            --white: #ffffff;
            --accent: #00c691; 
            --blue: #4169e1;
            --text: #333;
            --gray: #888;
            --danger: #ff5f5f;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg);
            margin: 0;
            color: var(--text);
            display: flex;
            justify-content: center;
        }

        .app-container {
            width: 100%;
            max-width: 480px; 
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }

        /* –®–ê–ü–ö–ê */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            margin-bottom: 20px;
        }
        .brand { font-size: 20px; font-weight: 800; display: flex; align-items: center; gap: 8px; }
        .brand span { color: var(--gray); font-weight: 400; }

        /* –ü–û–ò–°–ö */
        .search-bar {
            background: var(--white);
            padding: 15px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--gray);
            box-shadow: 0 4px 20px rgba(0,0,0,0.04);
            margin-bottom: 25px;
            font-size: 14px;
        }

        /* –ü–û–ö–ê–ó–ê–¢–ï–õ–ò (–ñ–ò–í–´–ï –î–ê–ù–ù–´–ï) */
        .stats-row {
            display: flex;
            justify-content: space-around;
            text-align: center;
            margin-bottom: 25px;
        }
        .stat-item h2 { margin: 0; color: var(--accent); font-size: 26px; letter-spacing: -1px; }
        .stat-item.blue h2 { color: var(--blue); }
        .stat-item p { margin: 5px 0; font-size: 11px; color: var(--gray); text-transform: uppercase; font-weight: 600; }

        .tasks-count {
            text-align: center;
            margin-bottom: 30px;
        }
        .tasks-count h1 { font-size: 56px; color: var(--danger); margin: 0; font-weight: 800; }
        .tasks-count p { color: var(--gray); font-size: 11px; text-transform: uppercase; font-weight: 700; letter-spacing: 1px; }

        /* –ö–ê–†–¢–û–ß–ö–ò –ú–û–î–£–õ–ï–ô */
        .card {
            background: var(--white);
            border-radius: 28px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 35px rgba(0,0,0,0.03);
            border: 1px solid rgba(0,0,0,0.02);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .icon-circle {
            width: 48px;
            height: 48px;
            background: #fcfcfc;
            border: 1px solid #f0f0f0;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #555;
        }

        .card-title h3 { margin: 0; font-size: 19px; font-weight: 700; }
        .card-title p { margin: 2px 0 0; font-size: 13px; color: var(--gray); }

        .menu-list { list-style: none; padding: 0; margin: 0; }
        .menu-link {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 0;
            color: var(--text);
            text-decoration: none;
            border-bottom: 1px solid #f8f8f8;
            font-size: 15px;
            font-weight: 500;
            transition: 0.2s;
        }
        .menu-link:hover { padding-left: 5px; color: var(--blue); }
        .menu-link:last-child { border: none; }
        .menu-link i { color: #ddd; font-size: 12px; }

        .loading-pulse { opacity: 0.5; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
    </style>
</head>
<body>

    <div class="app-container">
        <div class="header">
            <div class="brand">–ê–í–¢–û–ö–†–ê–°–ö–ò –î–í <span>PRO</span></div>
            <div class="icon-circle" style="width:38px; height:38px; border-radius:50%; background:#eee; border:none;">
                <i class="fa-solid fa-user" style="font-size:14px; color:#aaa;"></i>
            </div>
        </div>

        <div class="search-bar">
            <i class="fa-solid fa-magnifying-glass"></i>
            <span>–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏–ª–∏ —Å—á–µ—Ç–æ–≤...</span>
        </div>

        <div class="stats-row">
            <div class="stat-item">
                <h2 id="live-sku" class="loading-pulse">...</h2>
                <p>SKU –≤ –±–∞–∑–µ</p>
            </div>
            <div class="stat-item blue">
                <h2 id="live-qty" class="loading-pulse">...</h2>
                <p>–í—Å–µ–≥–æ –µ–¥.</p>
            </div>
        </div>

        <div class="tasks-count">
            <h1 id="live-tasks">5</h1>
            <p>–ó–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</p>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="icon-circle"><i class="fa-solid fa-cash-register"></i></div>
                <div class="card-title">
                    <h3>–ü—Ä–æ–¥–∞–∂–∏</h3>
                    <p>–ö–ª–∏–µ–Ω—Ç—ã –∏ –∫–∞—Å—Å–∞</p>
                </div>
            </div>
            <div class="menu-list">
                <a href="#" class="menu-link"><span>üìä –û—Ç—á–µ—Ç—ã –ø—Ä–æ–¥–∞–∂ (AI)</span> <i class="fa-solid fa-chevron-right"></i></a>
                <a href="#" class="menu-link"><span>üõí –†–ú–ö (–ö–∞—Å—Å–∞)</span> <i class="fa-solid fa-chevron-right"></i></a>
                <a href="#" class="menu-link"><span>üë• –ö–ª–∏–µ–Ω—Ç—ã (CRM)</span> <i class="fa-solid fa-chevron-right"></i></a>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="icon-circle"><i class="fa-solid fa-warehouse"></i></div>
                <div class="card-title">
                    <h3>–°–∫–ª–∞–¥—Å–∫–æ–π —É—á–µ—Ç</h3>
                    <p>–¢–æ–≤–∞—Ä—ã –∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∞</p>
                </div>
            </div>
            <div class="menu-list">
                <a href="nomenclature.html" class="menu-link"><span>üì¶ –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞</span> <i class="fa-solid fa-chevron-right"></i></a>
                <a href="stock.html" class="menu-link"><span>üìà –¢–µ–∫—É—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏</span> <i class="fa-solid fa-chevron-right"></i></a>
                <a href="#" class="menu-link"><span>üì• –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ</span> <i class="fa-solid fa-chevron-right"></i></a>
            </div>
        </div>

    </div>

    <script>
        // –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –§–£–ù–ö–¶–ò–û–ù–ê–õ–ê: –ó–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
        const API_URL = 'http://193.124.9.12:3000/api/stock';

        async function updateDashboard() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                
                // 1. –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (SKU)
                const skuCount = data.length;
                const skuElement = document.getElementById('live-sku');
                skuElement.innerText = skuCount;
                skuElement.classList.remove('loading-pulse');

                // 2. –°—á–∏—Ç–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à—Ç—É–∫ –Ω–∞ —Å–∫–ª–∞–¥–µ
                let totalQty = 0;
                data.forEach(item => {
                    totalQty += parseFloat(item.qty || 0);
                });
                
                const qtyElement = document.getElementById('live-qty');
                qtyElement.innerText = Math.round(totalQty);
                qtyElement.classList.remove('loading-pulse');

                console.log("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ –ë–î Postgres");
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:", error);
                document.getElementById('live-sku').innerText = "Err";
                document.getElementById('live-qty').innerText = "Err";
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        updateDashboard();
        
        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(updateDashboard, 30000);
    </script>
</body>
</html>
